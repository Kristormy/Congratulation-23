<!DOCTYPE html>
<html lang="ru">
<head>	 
	<meta name="description" content="Поздравление с 23 февраля! Сыграй в игру и проверь свою меткость!"/>
	<title>Поздравление с 23 февраля! Сыграй в игру и проверь свою меткость!</title> 
	<meta charset="utf-8">
	<link href="https://fonts.googleapis.com/css?family=PT+Mono&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="style.css">
    <script src="js/jquery-1.5.min.js"></script>
    <script src="js/jquery-ui-1.8.9.custom.min.js"></script>
	<script src="js/mail.js"></script>
    <script>
    var miss = 0;
    var hit = 0;
        
    $(document).ready(function() {

        var play;

        $("#btnstart").click(function(){
            startplay();
        });

        function startplay() {
            $("#message").fadeOut('slow');
            $(".character").fadeOut('slow');
            $("#hit").html("0 попал");
			$("#miss").html("0 мимо");
            hit = 0;
			miss = 0;
            $("#btnstart").css("color", "#e3e3e3");
            $("#btnstart").unbind("click");
            play = setInterval(scramble, 1800);
            setTimeout(function() {
                clearInterval(play);
                $("#btnstart").css("color", "#333333");
                $("#btnstart").bind("click", startplay);

                // Выводим финальное сообщение
                var containerPos = $('#container').offset();
                $("#message").animate({
                    top: containerPos.top,
                    left: containerPos.left
                    }, 'fast', function() {
                        setTimeout(function() {
                            $("#message").fadeIn('slow');
                            $(".character").fadeIn('slow');
                        }, 500);
                });
            }, 30000);
        }

        $(".character").click(function() {
            if ($(this).hasClass("ally")) {
                $(this).effect("bounce", {
                    times: 2,
                    direction: 'left'
                }, 300);
                $(this).slideUp("fast");
                miss++;
                $("#miss").html(miss + " мимо");
            } else {

                $(this).effect("explode", 500);
                hit++;
                $("#hit").html(hit + " в цель");
            }
        });
    });

    function randomFromTo(from, to){
        return Math.floor(Math.random() * (to - from + 1) + from);
    }

    function scramble() {
        var children = $('#container').children();

        var randomId = randomFromTo(1, children.length);
        moveRandom('char'+randomId);
        setTimeout(function(){
            $("#char"+randomId).slideDown('fast');            
        }, 500);
        
        setTimeout(function() {
            $("#char"+randomId).slideUp('fast');
        }, 1500);
    }

    function moveRandom(id) {
        /* Получаем положение контейнера и размер
         * -- метод доступа: cPos.top и cPos.left */
        var cPos = $('#container').offset();
        var cHeight = $('#container').height();
        var cWidth = $('#container').width();

        // Получаем отступы прямоугольника (предполагаем, что все отступы равны)
        var pad = parseInt($('#container').css('padding-top').replace('%', ''));

        // Получаем размер перемещаемого прямоугольника
        var bHeight = $('#'+id).height();
        var bWidth = $('#'+id).width();

        // Устанавливаем максимум для положения
        maxY = cPos.top + cHeight - bHeight - pad;
        maxX = cPos.left + cWidth - bWidth - pad;

        // Устанавливаем минимум для положение
        minY = cPos.top + pad;
        minX = cPos.left + pad;

        // Устанавливаем новое положение
        newY = randomFromTo(minY, maxY);
        newX = randomFromTo(minX, maxX);

        $('#'+id).animate({
            top: newY,
            left: newX
            }, 'slow', function() {
        });
    }
    </script>
	
</head>

<body>

<img id="Pic1" alt="С Днем Защитника Отечества!" src="img/Text.png">
    <div id="stat">
       <span id="miss">0 попал</span>
        &nbsp;
       <span id="hit">0 мимо</span> 
        &nbsp;
		<br><br>
        <a id="btnstart" href="javascript://" >Играть</a>
	
   </div>
 
    <div id="note">
        Нажмите &quot;Играть&quot;, чтобы проверить свою реакцию. <br> Игра длится 30 секунд,
       в животных попадать нельзя.
    </div>

    <div id="container">

        <div id="char1" class="character enemy1"></div>
        <div id="char2" class="character enemy2"></div>
        <div id="char3" class="character enemy3"></div>
        <div id="char4" class="character ally"></div>
    </div>

    <div id="message">	
	<img id="Pic2" alt="Ура! Ура! Ура!" src="img/Text3.png">
		<p id="text"></p> 
	
		<p><button id="generate">Ваше поздравление</button></p>
			<img alt="Звезды" id="star" src="img/star1.png">
	   

		
    </div>
</body>
</html>
